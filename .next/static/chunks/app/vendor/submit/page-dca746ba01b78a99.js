(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[306],{2214:(e,a,s)=>{"use strict";s.d(a,{N:()=>r});let r=(0,s(851).UU)("http://82.153.226.235:8000","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlzcyI6InN1cGFiYXNlIiwiaWF0IjoxNzQ1OTUxNTQ0LCJleHAiOjE5MDM2MzE1NDR9.aNiUNHUZwPBnIC7Ar5qQaMKR7bZtg41coG3YDhslhCM",{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0},global:{headers:{"ngrok-skip-browser-warning":"1231"}}})},2403:(e,a,s)=>{"use strict";s.d(a,{default:()=>o});var r=s(5155),t=s(2115),i=s(5695),n=s(2214);function l(e){let{onSubmit:a,initialData:s={},buttonText:i="Submit",isSubmitting:n=!1}=e,[l,o]=(0,t.useState)({vendorName:"",simjaNumber:"",jobDescription:"",startDate:"",endDate:"",startTime:"",endTime:"",equipment:"",sikaNumber:"",workerCount:"",simjaFileName:s.simja_file_name||"",sikaFileName:s.sika_file_name||"",idCardFileName:s.id_card_file_name||"",...s}),[d,m]=(0,t.useState)({}),c=e=>{let{name:a,value:s,type:r,files:t}=e.target;if("file"===r&&t[0]){let e=t[0].name,s=a.replace("File","FileName");o(a=>({...a,[s]:e}))}else o(e=>({...e,[a]:s}));d[a]&&m(e=>({...e,[a]:null}))},u=()=>{let e={};if(l.vendorName||(e.vendorName="Nama vendor harus diisi"),l.simjaNumber||(e.simjaNumber="Nomor SIMJA harus diisi"),l.jobDescription||(e.jobDescription="Deskripsi pekerjaan harus diisi"),l.startDate||(e.startDate="Tanggal mulai harus diisi"),l.endDate||(e.endDate="Tanggal selesai harus diisi"),l.startTime||(e.startTime="Jam mulai harus diisi"),l.endTime||(e.endTime="Jam selesai harus diisi"),l.workerCount||(e.workerCount="Jumlah pekerja harus diisi"),l.startDate&&l.endDate){let a=new Date(l.startDate);new Date(l.endDate)<a&&(e.endDate="Tanggal selesai tidak boleh sebelum tanggal mulai")}return m(e),0===Object.keys(e).length},x=async e=>{if(e.preventDefault(),!u()){var r;let e=Object.keys(d)[0];null==(r=document.getElementsByName(e)[0])||r.scrollIntoView({behavior:"smooth",block:"center"});return}try{console.log("Form data before submission:",l);let e={vendor_name:l.vendorName||"",simja_number:l.simjaNumber||"",sika_number:l.sikaNumber||"",job_description:l.jobDescription||"",start_date:l.startDate||"",end_date:l.endDate||"",start_time:l.startTime||"",end_time:l.endTime||"",equipment:l.equipment||"",worker_count:parseInt(l.workerCount,10)||0,status:"Pending",updated_at:new Date,simja_file_name:l.simjaFileName||"",sika_file_name:l.sikaFileName||"",id_card_file_name:l.idCardFileName||""};if(console.log("Submission data being sent to Supabase:",e),!e.vendor_name)return void alert("Nama vendor harus diisi");if(!e.simja_number)return void alert("Nomor SIMJA harus diisi");if(!e.job_description)return void alert("Deskripsi pekerjaan harus diisi");if(!e.start_date)return void alert("Tanggal mulai harus diisi");if(!e.end_date)return void alert("Tanggal selesai harus diisi");if(!e.start_time)return void alert("Jam mulai harus diisi");if(!e.end_time)return void alert("Jam selesai harus diisi");s.id||(e.created_at=new Date),await a(e),s.id||o({vendorName:"",simjaNumber:"",jobDescription:"",startDate:"",endDate:"",startTime:"",endTime:"",equipment:"",sikaNumber:"",workerCount:"",simjaFileName:"",sikaFileName:"",idCardFileName:""})}catch(e){console.error("Error submitting form:",e),alert("Terjadi kesalahan saat mengirim data: "+(e.message||"Unknown error"))}};return(0,r.jsxs)("form",{onSubmit:x,className:"space-y-8 text-slate-700 max-w-5xl mx-auto",children:[(0,r.jsxs)("div",{className:"p-6 rounded-lg border border-slate-200 shadow-sm bg-white",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-slate-800 mb-4",children:"Vendor Information"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Nama Vendor"}),(0,r.jsx)("input",{name:"vendorName",value:l.vendorName,onChange:c,className:"w-full border ".concat(d.vendorName?"border-red-500":"border-slate-300"," rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors"),placeholder:"Masukkan nama vendor",required:!0}),d.vendorName&&(0,r.jsx)("p",{className:"text-red-500 text-xs mt-1",children:d.vendorName})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Nomor SIMJA"}),(0,r.jsx)("input",{name:"simjaNumber",value:l.simjaNumber,onChange:c,className:"w-full border ".concat(d.simjaNumber?"border-red-500":"border-slate-300"," rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors"),placeholder:"Masukkan nomor SIMJA",required:!0}),d.simjaNumber&&(0,r.jsx)("p",{className:"text-red-500 text-xs mt-1",children:d.simjaNumber})]})]})]}),(0,r.jsxs)("div",{className:"p-6 rounded-lg border border-slate-200 shadow-sm bg-white",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-slate-800 mb-4",children:"Detail Pekerjaan"}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Deskripsi Pekerjaan"}),(0,r.jsx)("textarea",{name:"jobDescription",value:l.jobDescription,onChange:c,rows:"3",className:"w-full border ".concat(d.jobDescription?"border-red-500":"border-slate-300"," rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors"),placeholder:"Jelaskan detail pekerjaan yang akan dilakukan",required:!0}),d.jobDescription&&(0,r.jsx)("p",{className:"text-red-500 text-xs mt-1",children:d.jobDescription})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Sarana Kerja"}),(0,r.jsx)("input",{name:"equipment",value:l.equipment,onChange:c,className:"w-full border ".concat(d.equipment?"border-red-500":"border-slate-300"," rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors"),placeholder:"Alat dan sarana yang digunakan"}),d.equipment&&(0,r.jsx)("p",{className:"text-red-500 text-xs mt-1",children:d.equipment})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Jumlah Pekerja"}),(0,r.jsx)("input",{type:"number",name:"workerCount",value:l.workerCount,onChange:c,className:"w-full border ".concat(d.workerCount?"border-red-500":"border-slate-300"," rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors"),placeholder:"Jumlah pekerja yang terlibat",required:!0}),d.workerCount&&(0,r.jsx)("p",{className:"text-red-500 text-xs mt-1",children:d.workerCount})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Nomor SIKA"}),(0,r.jsx)("input",{name:"sikaNumber",value:l.sikaNumber,onChange:c,className:"w-full border ".concat(d.sikaNumber?"border-red-500":"border-slate-300"," rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors"),placeholder:"Masukkan nomor SIKA"}),d.sikaNumber&&(0,r.jsx)("p",{className:"text-red-500 text-xs mt-1",children:d.sikaNumber})]})]})]}),(0,r.jsxs)("div",{className:"p-6 rounded-lg border border-slate-200 shadow-sm bg-white",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-slate-800 mb-4",children:"Jadwal Pekerjaan"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Tanggal Mulai"}),(0,r.jsx)("input",{type:"date",name:"startDate",value:l.startDate,onChange:c,className:"w-full border ".concat(d.startDate?"border-red-500":"border-slate-300"," rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors"),required:!0}),d.startDate&&(0,r.jsx)("p",{className:"text-red-500 text-xs mt-1",children:d.startDate})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Tanggal Selesai"}),(0,r.jsx)("input",{type:"date",name:"endDate",value:l.endDate,onChange:c,className:"w-full border ".concat(d.endDate?"border-red-500":"border-slate-300"," rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors"),required:!0}),d.endDate&&(0,r.jsx)("p",{className:"text-red-500 text-xs mt-1",children:d.endDate})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Jam Mulai"}),(0,r.jsx)("input",{type:"time",name:"startTime",value:l.startTime,onChange:c,className:"w-full border ".concat(d.startTime?"border-red-500":"border-slate-300"," rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-              transparent transition-colors"),required:!0}),d.startTime&&(0,r.jsx)("p",{className:"text-red-500 text-xs mt-1",children:d.startTime})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Jam Selesai"}),(0,r.jsx)("input",{type:"time",name:"endTime",value:l.endTime,onChange:c,className:"w-full border ".concat(d.endTime?"border-red-500":"border-slate-300"," rounded-md px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors"),required:!0}),d.endTime&&(0,r.jsx)("p",{className:"text-red-500 text-xs mt-1",children:d.endTime})]})]})]}),(0,r.jsxs)("div",{className:"p-6 rounded-lg border border-slate-200 shadow-sm bg-white",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-slate-800 mb-4",children:"Dokumen Pendukung"}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Upload SIMJA"}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"file",name:"simjaFile",onChange:c,className:"hidden",id:"simjaFile",accept:".pdf,.jpg,.jpeg,.png"}),(0,r.jsxs)("label",{htmlFor:"simjaFile",className:"flex items-center justify-center w-full border ".concat(d.simjaFile?"border-red-500":"border-slate-300"," border-dashed rounded-md px-4 py-3 bg-white hover:bg-slate-50 cursor-pointer transition-colors"),children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-slate-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),(0,r.jsx)("span",{className:"text-slate-600",children:l.simjaFileName?l.simjaFileName:"Pilih file SIMJA"})]})]}),d.simjaFile&&(0,r.jsx)("p",{className:"text-red-500 text-xs mt-1",children:d.simjaFile}),(0,r.jsx)("p",{className:"text-xs text-slate-500",children:"Format yang didukung: PDF, JPG, PNG (Maks. 5MB)"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Upload SIKA"}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"file",name:"sikaFile",onChange:c,className:"hidden",id:"sikaFile",accept:".pdf,.jpg,.jpeg,.png"}),(0,r.jsxs)("label",{htmlFor:"sikaFile",className:"flex items-center justify-center w-full border ".concat(d.sikaFile?"border-red-500":"border-slate-300"," border-dashed rounded-md px-4 py-3 bg-white hover:bg-slate-50 cursor-pointer transition-colors"),children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-slate-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),(0,r.jsx)("span",{className:"text-slate-600",children:l.sikaFileName?l.sikaFileName:"Pilih file SIKA"})]})]}),d.sikaFile&&(0,r.jsx)("p",{className:"text-red-500 text-xs mt-1",children:d.sikaFile}),(0,r.jsx)("p",{className:"text-xs text-slate-500",children:"Format yang didukung: PDF, JPG, PNG (Maks. 5MB)"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium",children:"Upload ID Card"}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"file",name:"idCardFile",onChange:c,className:"hidden",id:"idCardFile",accept:".pdf,.jpg,.jpeg,.png"}),(0,r.jsxs)("label",{htmlFor:"idCardFile",className:"flex items-center justify-center w-full border ".concat(d.idCardFile?"border-red-500":"border-slate-300"," border-dashed rounded-md px-4 py-3 bg-white hover:bg-slate-50 cursor-pointer transition-colors"),children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-slate-400 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),(0,r.jsx)("span",{className:"text-slate-600",children:l.idCardFileName?l.idCardFileName:"Pilih file ID Card"})]})]}),d.idCardFile&&(0,r.jsx)("p",{className:"text-red-500 text-xs mt-1",children:d.idCardFile}),(0,r.jsx)("p",{className:"text-xs text-slate-500",children:"Format yang didukung: PDF, JPG, PNG (Maks. 5MB)"})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-end pt-4 gap-4",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{window.history.back()},className:"px-6 py-3 bg-red-600 text-white rounded-md hover:bg-red-500 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 transition-colors font-medium",children:"Batal"}),(0,r.jsx)("button",{type:"submit",className:"px-6 py-3 bg-blue-800 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-medium ".concat(n?"opacity-70 cursor-not-allowed":""),disabled:n,children:n?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Mengirim..."]}):i})]})]})}function o(){let[e,a]=(0,t.useState)(null),[s,o]=(0,t.useState)(!1),[d,m]=(0,t.useState)(!1),c=(0,i.useRouter)(),u=(0,i.useSearchParams)().get("id");(0,t.useEffect)(()=>{u&&(o(!0),x(u))},[u]);let x=async e=>{try{var s;let{data:r,error:t}=await n.N.from("submissions").select("*").eq("id",e).single();if(t)throw t;let i={id:r.id,vendorName:r.vendor_name||"",simjaNumber:r.simja_number||"",sikaNumber:r.sika_number||"",jobDescription:r.job_description||"",startDate:r.start_date||"",endDate:r.end_date||"",startTime:r.start_time||"",endTime:r.end_time||"",equipment:r.equipment||"",workerCount:(null==(s=r.worker_count)?void 0:s.toString())||"",simjaFileName:r.simja_file_name||"",sikaFileName:r.sika_file_name||"",idCardFileName:r.id_card_file_name||""};a(i)}catch(e){console.error("Error fetching vendor:",e),alert("Error loading vendor data")}finally{o(!1)}},b=async e=>{m(!0);try{let a={vendor_name:e.vendor_name,simja_number:e.simja_number,sika_number:e.sika_number,job_description:e.job_description,start_date:e.start_date,end_date:e.end_date,start_time:e.start_time,end_time:e.end_time,equipment:e.equipment,worker_count:e.worker_count,status:u&&e.status||"Pending",updated_at:new Date,simja_file_name:e.simja_file_name,sika_file_name:e.sika_file_name,id_card_file_name:e.id_card_file_name};if(u){let{data:e,error:s}=await n.N.from("submissions").update(a).eq("id",u).select();if(s)throw s;e[0]}else{a.created_at=new Date;let{data:e,error:s}=await n.N.from("submissions").insert(a).select();if(s)throw s;e[0]}alert(u?"Pengajuan berhasil diperbarui!":"Pengajuan berhasil disimpan!"),c.push("/vendor/dashboard")}catch(e){console.error("Error submitting form:",e),alert("Terjadi kesalahan saat menyimpan data: "+e.message)}finally{m(!1)}};return s?(0,r.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):(0,r.jsxs)("div",{className:"container mx-auto py-8 px-4",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-6",children:u?"Edit Pengajuan Vendor":"Tambah Pengajuan Vendor"}),(0,r.jsx)(l,{onSubmit:b,initialData:e||{},buttonText:u?"Simpan Perubahan":"Submit Pengajuan",isSubmitting:d})]})}},5695:(e,a,s)=>{"use strict";var r=s(8999);s.o(r,"usePathname")&&s.d(a,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(a,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(a,{useSearchParams:function(){return r.useSearchParams}})},8039:(e,a,s)=>{Promise.resolve().then(s.bind(s,2403))}},e=>{var a=a=>e(e.s=a);e.O(0,[851,441,684,358],()=>a(8039)),_N_E=e.O()}]);